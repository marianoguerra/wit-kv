package wit-kv:storage@0.2.0;

interface types {
    /// Semantic version following WIT package versioning convention
    record semantic-version {
        major: u32,
        minor: u32,
        patch: u32,
    }

    /// Stored value envelope - wraps the actual value with metadata
    record stored-value {
        /// Format version for future compatibility
        version: u8,

        /// Type version at time of storage (semantic version)
        type-version: semantic-version,

        /// Canonical ABI encoded value bytes
        value: list<u8>,

        /// Linear memory bytes (for variable-length types: strings, lists)
        memory: option<list<u8>>,
    }

    /// Binary export format - self-describing canonical ABI encoding
    /// for transferring complete values including linear memory
    record binary-export {
        /// Canonical ABI encoded value bytes
        value: list<u8>,
        /// Linear memory bytes (for variable-length types)
        memory: option<list<u8>>,
    }

    /// Keyspace type metadata
    record keyspace-metadata {
        /// User-visible keyspace name
        name: string,

        /// Full WIT qualified name (namespace:package/interface#type)
        qualified-name: string,

        /// Full WIT type definition text
        wit-definition: string,

        /// Type name within the WIT definition
        type-name: string,

        /// Semantic version for the type schema
        type-version: semantic-version,

        /// CRC32 hash of WIT definition
        type-hash: u32,

        /// Unix timestamp of creation
        created-at: u64,
    }
}
